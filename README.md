# Effective Approaches to Attention-based Neural Machine Translation
An Implementation of Encoder-Decoder model with global attention mechanism (Luong et al, 2015).  This Stacked multiple layers of an RNN with a Long Short-Term Memory (LSTM) are used for both the encoder and the decoder. Also, global attention mechanism and input feeding approach is employeed. In training step, you can use schedule sampling (Bengio et al, 2015) to bridge the gap between training and inference for sequence prediction tasks.

## Usages
### Training
`--train`and `--valid` recieve the path to data file for training and validation, respectively. The data file must be tab-separated values (tsv) format. If you need to use gpu, please set `--gpu` option. `--tf-ratio` option means a ratio of supervised signal in decoding step.

```sh
python train.py \
    --gpu \
    --train ./sample_data/sample_train.tsv \
    --valid ./sample_data/sample_valid.tsv \
    --tf-ratio 0.5 \
    --savedir ./checkpoints 
```

### Translation
`--model` recieve the path to model file generated by `train.py`.  A text file which you want translate is given to `--input`. If you need to use gpu, please set `--gpu` option.
```sh
python translate.py \
    --gpu \
    --model ./checkpoints/checkpoint_best.pt \
    --input ./sample_data/sample_test.txt
```

## References
- [Minh-Thang Luong, Hieu Pham, and Christopher D Manning. Effective approaches to attention based neural machine translation. In EMNLP 2015, 1412–1421.](https://arxiv.org/pdf/1508.04025.pdf)
- [Bengio, S.; Vinyals, O.; Jaitly, N.; and Shazeer, N. Scheduled sampling for sequence prediction with recurrent neural networks. In NIPS 2015, 1171–1179.](https://arxiv.org/pdf/1506.03099.pdf)
